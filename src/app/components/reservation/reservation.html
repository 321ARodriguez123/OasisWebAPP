<div class="formulario-container">
  <h2>ğŸ¨ Formulario de Reserva</h2>
  
  <!-- === SECCIÃ“N 1: DATOS DE ESTANCIA === -->
  <fieldset class="grupo-disponibilidad">
      <legend>ğŸ“… Paso 1: Disponibilidad</legend>

      <div class="campo">
          <label>Tipo de HabitaciÃ³n:</label>
          <select [(ngModel)]="searchData.tipo_habitacion_id">
              <option value="" disabled selected>-- Selecciona un tipo --</option>
              <option *ngFor="let tipo of roomTypes" [value]="tipo.tipo_habitacion_id">
                  {{ tipo.nombre_tipo }} (Base: ${{ tipo.precio_base }})
              </option>
          </select>
      </div>

      <!-- NUEVO CAMPO: PERSONAS -->
      <div class="campo">
          <label>NÂ° Personas:</label>
          <input type="number" [(ngModel)]="searchData.numero_huespedes" min="1" placeholder="1">
      </div>

      <div class="campo-doble">
          <div>
              <label>Llegada:</label>
              <input type="date" [(ngModel)]="searchData.fecha_entrada">
          </div>
          <div>
              <label>Salida:</label>
              <input type="date" [(ngModel)]="searchData.fecha_final">
          </div>
      </div>

      <button type="button" class="btn-verificar" (click)="checkAvailability()">
          ğŸ” Verificar Disponibilidad
      </button>

      <div *ngIf="message" [class]="'alert ' + (messageType === 'success' ? 'alert-success' : 'alert-error')">
          {{ message }}
      </div>
  </fieldset>

  <hr>

  <!-- === SECCIÃ“N 2: CONFIRMACIÃ“N === -->
  <div *ngIf="isAvailable" class="fade-in">
      
      <fieldset class="grupo-titular">
          <legend>ğŸ‘¤ Paso 2: Titular de la Reserva</legend>
          
          <div class="formulario-huesped"> 
              <div class="campo">
                  <label>CÃ©dula de Identidad (C.I.):</label>
                  <input type="text" [(ngModel)]="holderData.titular_ci" placeholder="Ej: 849201">
              </div>
              <div class="campo">
                  <label>Nombres:</label>
                  <input type="text" [(ngModel)]="holderData.titular_nombre">
              </div>
              <div class="campo">
                  <label>Apellidos:</label>
                  <input type="text" [(ngModel)]="holderData.titular_apellido">
              </div>
          </div>
      </fieldset>
      
      <hr>

      <div class="campo servicios-adicionales">
          <label>Servicios Adicionales:</label>
          <div *ngFor="let svc of servicesList" class="checkbox-grupo">
              <input type="checkbox" [id]="'svc'+svc.servicio_id" 
                     [(ngModel)]="svc.selected" 
                     (change)="recalculateTotal()">
              <label [for]="'svc'+svc.servicio_id">
                  {{ svc.nombre_servicio }} (${{ svc.precio }})
              </label>
              <div *ngIf="svc.selected" class="input-cant-wrapper">
                  <label>Cant:</label>
                  <input type="number" [(ngModel)]="svc.cantidad" (change)="recalculateTotal()" min="1">
              </div>
          </div>
      </div>

      <hr>

      <div class="resumen-pago">
          <h3>HabitaciÃ³n Asignada: <span class="highlight">{{ assignedRoom?.numero_habitacion }}</span></h3>
          <p>HuÃ©spedes: <strong>{{ searchData.numero_huespedes }}</strong></p>
          <h2>Total a Pagar: ${{ totalEstimated | number:'1.2-2' }}</h2>
      </div>

      <button type="button" class="btn-confirmar" (click)="confirmReservation()">
          âœ… CONFIRMAR Y PAGAR
      </button>
  </div>
</div>